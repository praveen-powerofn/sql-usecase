1. create student table
CREATE TABLE STUDENT (
ID VARCHAR(6) NOT NULL, 
NAME VARCHAR(25) NOT NULL,
 DEPARTMENT VARCHAR(6) NOT NULL,
 CGPA DECIMAL(1,1) NOT NULL,
 PRIMARY KEY(ID));
2.create comapny table
CREATE TABLE COMPANY(
    -> ID VARCHAR(6) NOT NULL,
    -> NAME VARCHAR(25) NOT NULL,
    -> LOACATION VARCHAR(25) NOT NULL,
    -> INTERVIEW_DATE DATE NOT NULL,
    -> PRIMARY KEY(ID));
3.create placement table
create table PLACEMENT(
    -> S_ID VARCHAR(6) NOT NULL ,
    -> C_ID VARCHAR(6) NOT NULL, 
    -> PACKAGE BIGINT NOT NULL,
    -> PRIMARY KEY(S_ID));
since inserting into cgpa show error of “Out of range value for column 'CGPA' at row 1”
so i alter cgpa

ALTER TABLE STUDENT CHANGE COLUMN CGPA CGPA DECIMAL(2,1);

insert data into student
INSERT INTO STUDENT (ID,NAME,DEPARTMENT,CGPA)               VALUES(“S001”,”ARUN”,”CSE”,8.0)
     -> ("S002","GITA","CS",7.5),
    -> ("S003","KUMAR","IT",6.0),
    -> ("S004","ROHIT","IT",8.5),
    -> ("S005","YAMUNA","ECE",9.0),
    -> ("S006","YOGESH","ECE",9.0));
Insert Data Into Company
INSERT INTO COMPANY (ID,NAME,LOCATION,INTERVIEW_DATE)  VALUE
   ->("C001","MICROSOFT","BANGALORE","2020-08-01")
    ->("C002","AMAZON","CHENNAI","2020-09-10"),
    -> ("C003","FLIPCART","BANGALORE","2020-09-15"),
    -> ("C004","HONEYWELL","HYDERABAD","2020-10-30"),
    -> ("C005","ACCENTURE","CHENNAI","2020-11-30"),
    -> ("C006","WIPRO","NOIDA","2020-12-31");
INSERT DATA INTO PLACEMENT
i notice that i declare S_ID as my primary but it is not unique so i drop the constaint
ALTER TABLE PLACEMENT DROP PRIMARY KEY;

INSERT INTO PLACEMENT(S_ID,C_ID,PACKAGE) 
    -> VALUES
    -> ("S001","C001",2000000),
    -> ("S002","C001",2000000),
    -> ("S003","C002",1200000),
    -> ("S004","C004",700000),
    -> ("S004","C006",400000),
    -> ("S006","C004",700000);


1) Write a SQL query to find student who got placed with highest package, along with the name of the company.

SELECT STUDENT.NAME,COMPANY.NAME,PLACEMENT.PACKAGE FROM STUDENT JOIN COMPANY JOIN PLACEMENT ON STUDENT.ID=PLACEMENT.S_ID AND COMPANY.ID=PLACEMENT.C_ID WHERE PACKAGE=(SELECT MAX(PACKAGE) FROM PLACEMENT);


2) HOD of ECE department wants to know placement details of all his department students, Write a SQL query for this scenario

SELECT STUDENT.NAME AS STUDENT,STUDENT.DEPARTMENT,CASE WHEN COMPANY.NAME IS NULL THEN "NO" ELSE "YES" END AS PLACED,IFNULL(COMPANY.NAME,"-") AS COMPANY,IFNULL(PLACEMENT.PACKAGE,"-") AS PACKAGE FROM STUDENT LEFT JOIN PLACEMENT ON STUDENT.ID =PLACEMENT.S_ID LEFT JOIN COMPANY ON COMPANY.ID=PLACEMENT.C_ID WHERE STUDENT.DEPARTMENT="ECE" ORDER BY COMPANY;


3) Write a SQL query to display total number of students each company has hired

SELECT COMPANY.NAME, COUNT(COMPANY.NAME)  FROM COMPANY  INNER JOIN PLACEMENT ON  COMPANY.ID=PLACEMENT.C_ID GROUP BY COMPANY.NAME DESC;


4) Write a SQL query which displays list of companies conducted interview in month of september

SELECT MONTHNAME(INTERVIEW_DATE) AS MONTH ,NAME AS COMPANY FROM COMPANY  WHERE MONTHNAME(INTERVIEW_DATE)='SEPTEMBER';

5) Write a SQL query which displays list of companies which conducted interview till date

SELECT * FROM COMPANY WHERE INTERVIEW_DATE<=NOW();

6) Dean would like to know the students who got more than one placement offer, write a SQL query for this scenario

CREATE TABLE TEMP1 AS (SELECT STUDENT.NAME,COMPANY.NAME AS CNAME FROM STUDENT JOIN COMPANY JOIN PLACEMENT ON STUDENT.ID=PLACEMENT.S_ID AND COMPANY.ID=PLACEMENT.C_ID);
SELECT NAME, CNAME FROM TEMP1 WHERE NAME=(SELECT NAME FROM TEMP1 GROUP BY NAME HAVING COUNT(NAME)>1);

7)Accenture would like to shortlist candidates with CGPA > 7 and no need of student who already got placed, write SQL query that statisfies their given criteria

SELECT NAME,DEPARTMENT,CGPA FROM STUDENT WHERE ID NOT IN (SELECT S_ID FROM PLACEMENT);

QUESTION 8
SELECT NAME,LOCATION FROM COMPANY WHERE LOCATION LIKE 'B%';



