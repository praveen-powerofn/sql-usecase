					USECASE 4


1.GET EMPLOYESS STRENGTH IN EACH DEPARTMENT 

select DEPARTMENT.ID,DEPARTMENT.NAME as DEPARTMENT,COUNT(EMPLOYEE.DEPARTMENT) as STRENGTH from DEPARTMENT join EMPLOYEE on DEPARTMENT.ID=EMPLOYEE.DEPARTMENT group by EMPLOYEE.DEPARTMENT;





2.LIST EACH EMPLOYEES L2, L1 REPORTING SENIORS

SELECT EMPLOYEE.ID AS ID,EMPLOYEE.NAME AS EMPLOYEE,L2,L1 FROM EMPLOYEE JOIN (SELECT EMPLOYEE.ID AS ID,IF(L2 IS NULL,'-',(SELECT NAME FROM EMPLOYEE WHERE ID=L2)) AS L2,IF (L1 IS NULL,'-',(SELECT NAME FROM EMPLOYEE WHERE ID=L1)) AS L1 FROM EMPLOYEE JOIN REPORTING ON EMPLOYEE.ID = REPORTING.ID) REP ON EMPLOYEE.ID = REP.ID where EMPLOYEE.ACTIVE=1 ORDER BY EMPLOYEE.ID;

4.GET LIST OF ALL EMPLOYEES WHO HAS PART OF OUR TEAM FOR MORE THAN 1500 DAYS
select EMPLOYEE.ID,EMPLOYEE.NAME,EMPLOYEE.DEPARTMENT,DATEDIFF(curdate(),EMP_ACTIVE_DATE.ACTIVE_FROM) as DAYS from EMPLOYEE join EMP_ACTIVE_DATE on EMPLOYEE.iD=EMP_ACTIVE_DATE.ID where DATEDIFF(curdate(),EMP_ACTIVE_DATE.ACTIVE_FROM)>1500;


QUESTION 5 
CALCULATE THE STRENGTH (IN RATIO) OF FEMALE EMPLOYEES IN EACH DEPARTMENT
SELECT GET_EACHGENDER_COUNT.NAME AS DEPARTMENT,FEMALECOUNT*100/TOTAL AS PERCENTAGE FROM( SELECT COUNT(*) AS TOTAL,DEPARTMENT FROM EMPLOYEE GROUP BY DEPARTMENT) AS COUNTLIST JOIN  (select DEPARTMENT.ID AS DEPARTMENT,DEPARTMENT.NAME,EMPLOYEE.GENDER AS GENDER,COUNT(GENDER) AS FEMALECOUNT FROM DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.ID=EMPLOYEE.DEPARTMENT GROUP BY EMPLOYEE.GENDER,DEPARTMENT.NAME HAVING EMPLOYEE.GENDER="F") AS GET_EACHGENDER_COUNT ON COUNTLIST.DEPARTMENT=GET_EACHGENDER_COUNT.DEPARTMENT;

select DEPARTMENT.NAME as DEPARTMENT,(COUNT(if(GENDER='F',1,null))*100/count(if(GENDER='F',1,1))) as PERCENT from DEPARTMENT join EMPLOYEE on DEPARTMENT.ID=EMPLOYEE.DEPARTMENT group by DEPARTMENT.NAME;


