CREATE TABLE 
DEVICE
(TIME TIMESTAMP NOT NULL,
DEVICE VARCHAR(2) NOT NULL,
CONSUMPTION DECIMAL(4,3) NOT NULL
)
;

QUESTION 1

load data local infile '/home/praveen/devicedb.csv’ into table DEVICE fields terminated by ','  ignore 1 rows;


QUESTION 2

SELECT TIME,DEVICE,COUNT(TIME) FROM DEVICE GROUP BY DEVICE,TIME HAVING COUNT(TIME)>1;

QUESTION 3

select min(TIME), max(TIME) from (select TIME, row_number() over (order by TIME) as missing from DEVICE) DEVICE group by (TIME - missing);

QUESTION 4

SELECT DEVICE,HOUR(TIME),SUM(CONSUMPTION) FROM DEVICE GROUP BY (HOUR(TIME)),DEVICE;

QUESTION 5

SELECT DEVICE,HOUR(TIME),MAX(CONSUMPTION) FROM DEVICE  GROUP BY DEVICE,HOUR(TIME);

SELECT DEVICE,CONSUMPTION FROM DEVICE WHERE CONSUMPTION=(SELECT MAX(CONSUMPTION) FROM DEVICE) GROUP BY DEVICE;


